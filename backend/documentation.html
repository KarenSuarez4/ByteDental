<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ByteDental Backend - Documentaci√≥n T√©cnica</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f7fa;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
            padding: 60px 20px;
            margin-bottom: 40px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .nav-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            position: sticky;
            top: 20px;
            z-index: 100;
        }

        .nav-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .nav-item {
            background: #f8f9ff;
            padding: 15px;
            border-radius: 8px;
            text-decoration: none;
            color: #5a67d8;
            font-weight: 600;
            text-align: center;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .nav-item:hover {
            background: #5a67d8;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(90, 103, 216, 0.3);
        }

        .section {
            background: white;
            margin-bottom: 30px;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .section h2 {
            color: #5a67d8;
            font-size: 2.5em;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            border-bottom: 3px solid #e2e8f0;
            padding-bottom: 15px;
        }

        .section h3 {
            color: #2d3748;
            font-size: 1.8em;
            margin: 30px 0 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section h4 {
            color: #4a5568;
            font-size: 1.4em;
            margin: 20px 0 10px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .highlight-box {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(240, 147, 251, 0.3);
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .info-card {
            background: #f7fafc;
            padding: 25px;
            border-radius: 10px;
            border-left: 5px solid #5a67d8;
            transition: all 0.3s ease;
        }

        .info-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .info-card h4 {
            color: #5a67d8;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .features-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .feature-item {
            background: #e6fffa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #38b2ac;
            font-weight: 500;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .metric-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .metric-number {
            font-size: 2.5em;
            font-weight: bold;
            display: block;
        }

        .metric-label {
            font-size: 0.9em;
            opacity: 0.9;
            margin-top: 5px;
        }

        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 25px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .architecture-diagram {
            background: #f7fafc;
            padding: 30px;
            border-radius: 10px;
            font-family: monospace;
            font-size: 0.85em;
            line-height: 1.4;
            border: 2px solid #e2e8f0;
            overflow-x: auto;
            margin: 20px 0;
        }

        .table-container {
            overflow-x: auto;
            margin: 20px 0;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        th {
            background: #5a67d8;
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background: #f7fafc;
        }

        .tag {
            display: inline-block;
            background: #5a67d8;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
            margin: 3px;
        }

        .tag.success { background: #38a169; }
        .tag.warning { background: #d69e2e; }
        .tag.info { background: #3182ce; }
        .tag.danger { background: #e53e3e; }

        footer {
            background: #2d3748;
            color: white;
            text-align: center;
            padding: 40px 20px;
            margin-top: 50px;
            border-radius: 10px;
        }

        @media (max-width: 768px) {
            .container { padding: 10px; }
            header h1 { font-size: 2em; }
            .section { padding: 20px; }
            .nav-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ü¶∑ ByteDental Backend</h1>
            <p>Documentaci√≥n T√©cnica Completa - API REST con FastAPI</p>
            <p><strong>Versi√≥n 2.0.0</strong> | Septiembre 2025</p>
        </header>

        <div class="nav-container">
            <h3 style="text-align: center; margin-bottom: 20px; color: #5a67d8;">üìã Navegaci√≥n R√°pida</h3>
            <div class="nav-grid">
                <a href="#informacion-general" class="nav-item">üìä Informaci√≥n General</a>
                <a href="#arquitectura" class="nav-item">üèóÔ∏è Arquitectura</a>
                <a href="#estructura" class="nav-item">üìÅ Estructura</a>
                <a href="#tecnologias" class="nav-item">üõ†Ô∏è Tecnolog√≠as</a>
                <a href="#configuracion" class="nav-item">‚öôÔ∏è Configuraci√≥n</a>
                <a href="#modelos" class="nav-item">üìä Modelos BD</a>
                <a href="#autorizacion" class="nav-item">üõ°Ô∏è Autorizaci√≥n</a>
                <a href="#endpoints" class="nav-item">üõ£Ô∏è Endpoints</a>
                <a href="#servicios" class="nav-item">üîß Servicios</a>
                <a href="#auditoria" class="nav-item">üìã Auditor√≠a</a>
                <a href="#instalacion" class="nav-item">üöÄ Instalaci√≥n</a>
                <a href="#despliegue" class="nav-item">üåê Despliegue</a>
            </div>
        </div>

        <section id="informacion-general" class="section">
            <h2>üìä Informaci√≥n General</h2>
            
            <div class="highlight-box">
                <h3>üéØ ByteDental Backend</h3>
                <p><strong>API REST desarrollada con FastAPI</strong> que proporciona servicios completos para la gesti√≥n de usuarios, autenticaci√≥n, autorizaci√≥n por roles, auditor√≠a y comunicaciones por email en un sistema odontol√≥gico.</p>
            </div>

            <h3>üéØ Caracter√≠sticas Principales</h3>
            <div class="features-list">
                <div class="feature-item">‚úÖ <strong>Sistema de autenticaci√≥n</strong> con Firebase Authentication</div>
                <div class="feature-item">‚úÖ <strong>Autorizaci√≥n por roles</strong> (Administrator, Doctor, Assistant, Auditor)</div>
                <div class="feature-item">‚úÖ <strong>Gesti√≥n completa de usuarios</strong> con CRUD protegido</div>
                <div class="feature-item">‚úÖ <strong>Auditor√≠a integral</strong> de todas las acciones del sistema</div>
                <div class="feature-item">‚úÖ <strong>Servicio de emails</strong> con plantillas HTML</div>
                <div class="feature-item">‚úÖ <strong>Sistema OTP</strong> para verificaci√≥n</div>
                <div class="feature-item">‚úÖ <strong>Base de datos PostgreSQL</strong> con migraciones</div>
                <div class="feature-item">‚úÖ <strong>Dockerizado</strong> para desarrollo y producci√≥n</div>
                <div class="feature-item">‚úÖ <strong>CORS configurado</strong> para m√∫ltiples entornos</div>
            </div>

            <h3>üìà M√©tricas del Proyecto</h3>
            <div class="metrics-grid">
                <div class="metric-card">
                    <span class="metric-number">2.0.0</span>
                    <span class="metric-label">Versi√≥n</span>
                </div>
                <div class="metric-card">
                    <span class="metric-number">2,500+</span>
                    <span class="metric-label">L√≠neas de C√≥digo</span>
                </div>
                <div class="metric-card">
                    <span class="metric-number">25+</span>
                    <span class="metric-label">Endpoints</span>
                </div>
                <div class="metric-card">
                    <span class="metric-number">5</span>
                    <span class="metric-label">Modelos Principales</span>
                </div>
                <div class="metric-card">
                    <span class="metric-number">4</span>
                    <span class="metric-label">Roles de Usuario</span>
                </div>
                <div class="metric-card">
                    <span class="metric-number">100%</span>
                    <span class="metric-label">Endpoints Protegidos</span>
                </div>
            </div>

            <h3>üè¢ Tecnolog√≠as Principales</h3>
            <div class="info-grid">
                <div class="info-card">
                    <h4>üêç Backend Framework</h4>
                    <p><strong>FastAPI</strong> - Framework web moderno y r√°pido para Python, con documentaci√≥n autom√°tica y validaci√≥n de tipos.</p>
                </div>
                <div class="info-card">
                    <h4>üóÑÔ∏è Base de Datos</h4>
                    <p><strong>PostgreSQL</strong> - Sistema de gesti√≥n de base de datos relacional robusto y escalable.</p>
                </div>
                <div class="info-card">
                    <h4>üîê Autenticaci√≥n</h4>
                    <p><strong>Firebase Authentication</strong> - Servicio de autenticaci√≥n de Google con JWT tokens.</p>
                </div>
                <div class="info-card">
                    <h4>üê≥ Contenedores</h4>
                    <p><strong>Docker</strong> - Containerizaci√≥n para desarrollo y despliegue consistente.</p>
                </div>
            </div>
        </section>

        <section id="arquitectura" class="section">
            <h2>üèóÔ∏è Arquitectura del Sistema</h2>
            
            <div class="architecture-diagram">
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     CLIENTE (Frontend)                     ‚îÇ
‚îÇ                   React + Firebase Auth                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                      ‚îÇ HTTPS/JWT Token
                      ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    FASTAPI SERVER                          ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ   MIDDLEWARE    ‚îÇ     ROUTERS     ‚îÇ    SERVICES     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                 ‚îÇ                 ‚îÇ                 ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Auth         ‚îÇ ‚Ä¢ Users         ‚îÇ ‚Ä¢ User Service  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ CORS         ‚îÇ ‚Ä¢ Auditoria     ‚îÇ ‚Ä¢ Firebase      ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Logging      ‚îÇ ‚Ä¢ Email         ‚îÇ ‚Ä¢ Email         ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                ‚îÇ ‚Ä¢ OTP           ‚îÇ ‚Ä¢ Auditoria     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                ‚îÇ ‚Ä¢ Auth          ‚îÇ ‚Ä¢ OTP           ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                      ‚îÇ SQL Queries
                      ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   POSTGRESQL DATABASE                      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ   users     ‚îÇ    roles     ‚îÇ audit_logs ‚îÇ   otp_codes  ‚îÇ ‚îÇ
‚îÇ  ‚îÇ   emails    ‚îÇ              ‚îÇ            ‚îÇ              ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                      ‚îÇ
                      ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                SERVICIOS EXTERNOS                          ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ  Firebase Auth  ‚îÇ   Gmail SMTP    ‚îÇ   Render Cloud  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                 ‚îÇ                 ‚îÇ                 ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Autenticaci√≥n ‚îÇ ‚Ä¢ Env√≠o emails  ‚îÇ ‚Ä¢ Hosting       ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ JWT Tokens    ‚îÇ ‚Ä¢ Plantillas    ‚îÇ ‚Ä¢ Base de datos ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Gesti√≥n users ‚îÇ ‚Ä¢ OTP codes     ‚îÇ ‚Ä¢ SSL/TLS       ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            </div>

            <h3>üîÑ Flujo de Autenticaci√≥n y Autorizaci√≥n</h3>
            <div class="info-grid">
                <div class="info-card">
                    <h4>1Ô∏è‚É£ Autenticaci√≥n</h4>
                    <p>Usuario ‚Üí Login en Frontend ‚Üí Firebase Auth ‚Üí Genera JWT Token</p>
                </div>
                <div class="info-card">
                    <h4>2Ô∏è‚É£ Request</h4>
                    <p>Frontend ‚Üí Env√≠a requests con Bearer Token ‚Üí FastAPI Middleware</p>
                </div>
                <div class="info-card">
                    <h4>3Ô∏è‚É£ Validaci√≥n</h4>
                    <p>Middleware ‚Üí Valida JWT con Firebase ‚Üí Database ‚Üí Verifica rol</p>
                </div>
                <div class="info-card">
                    <h4>4Ô∏è‚É£ Ejecuci√≥n</h4>
                    <p>Endpoint ‚Üí Ejecuta seg√∫n permisos ‚Üí Auditor√≠a ‚Üí Response</p>
                </div>
            </div>
        </section>

        <section id="estructura" class="section">
            <h2>üìÅ Estructura del Proyecto</h2>
            
            <div class="code-block">
backend/
‚îú‚îÄ‚îÄ üîß Configuraci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ .env                           # Variables de entorno
‚îÇ   ‚îú‚îÄ‚îÄ .gitignore                     # Archivos ignorados por Git
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt               # Dependencias Python
‚îÇ   ‚îú‚îÄ‚îÄ alembic.ini                   # Configuraci√≥n migraciones
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.yml            # Docker para BD
‚îÇ   ‚îî‚îÄ‚îÄ main.py                       # Aplicaci√≥n principal FastAPI
‚îÇ
‚îú‚îÄ‚îÄ üèóÔ∏è Aplicaci√≥n Principal
‚îÇ   ‚îî‚îÄ‚îÄ app/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ config.py                 # Configuraci√≥n centralizada
‚îÇ       ‚îú‚îÄ‚îÄ database.py               # Conexi√≥n a PostgreSQL
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ üõ°Ô∏è middleware/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ auth_middleware.py    # Autorizaci√≥n por roles
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ üìä models/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ user_models.py        # Modelo de usuarios
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ rol_models.py         # Modelo de roles
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ auditoria_models.py   # Modelo de auditor√≠a
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ email_models.py       # Modelo de emails
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ otp_models.py         # Modelo de c√≥digos OTP
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ üõ£Ô∏è routers/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ users.py              # CRUD usuarios (Admin only)
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ auditoria.py          # Logs auditor√≠a (Auditor only)
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ auth.py               # Autenticaci√≥n
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ email_router.py       # Gesti√≥n de emails
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ otp_router.py         # Gesti√≥n de OTP
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ üîß services/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ user_service.py       # L√≥gica de negocio usuarios
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ firebase_service.py   # Integraci√≥n Firebase
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ auditoria_service.py  # L√≥gica de auditor√≠a
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ email_service.py      # Servicio de emails
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ otp_service.py        # Servicio de c√≥digos OTP
‚îÇ       ‚îÇ
‚îÇ       ‚îî‚îÄ‚îÄ üìß templates/
‚îÇ           ‚îú‚îÄ‚îÄ general_email.html    # Plantilla email general
‚îÇ           ‚îî‚îÄ‚îÄ otp_email.html        # Plantilla email OTP
‚îÇ
‚îú‚îÄ‚îÄ üóÑÔ∏è Base de Datos
‚îÇ   ‚îî‚îÄ‚îÄ init-scripts/
‚îÇ       ‚îî‚îÄ‚îÄ 01-init.sql              # Script inicial de BD
‚îÇ
‚îú‚îÄ‚îÄ üîß Scripts
‚îÇ   ‚îî‚îÄ‚îÄ scripts/
‚îÇ       ‚îî‚îÄ‚îÄ insert_roles.py          # Inserci√≥n de roles iniciales
‚îÇ
‚îî‚îÄ‚îÄ üîê Credenciales
    ‚îî‚îÄ‚îÄ bytedental-***-firebase-adminsdk-***.json  # Credenciales Firebase
            </div>

            <h3>üìã Descripci√≥n de Componentes</h3>
            <div class="info-grid">
                <div class="info-card">
                    <h4>üõ°Ô∏è Middleware</h4>
                    <p>Gesti√≥n de autenticaci√≥n, autorizaci√≥n por roles, CORS y logging de requests.</p>
                </div>
                <div class="info-card">
                    <h4>üìä Models</h4>
                    <p>Definici√≥n de esquemas de base de datos usando SQLAlchemy ORM.</p>
                </div>
                <div class="info-card">
                    <h4>üõ£Ô∏è Routers</h4>
                    <p>Endpoints de la API organizados por funcionalidad con protecci√≥n por roles.</p>
                </div>
                <div class="info-card">
                    <h4>üîß Services</h4>
                    <p>L√≥gica de negocio separada de los endpoints para mejor organizaci√≥n.</p>
                </div>
            </div>
        </section>

        <section id="tecnologias" class="section">
            <h2>üõ†Ô∏è Tecnolog√≠as y Dependencias</h2>
            
            <h3>üêç Framework Principal</h3>
            <div class="info-grid">
                <div class="info-card">
                    <h4>FastAPI</h4>
                    <p>Framework web moderno y r√°pido para Python con documentaci√≥n autom√°tica</p>
                    <span class="tag">Python</span><span class="tag">Web Framework</span>
                </div>
                <div class="info-card">
                    <h4>Uvicorn</h4>
                    <p>Servidor ASGI lightning-fast para aplicaciones FastAPI</p>
                    <span class="tag">ASGI</span><span class="tag">Server</span>
                </div>
                <div class="info-card">
                    <h4>Pydantic</h4>
                    <p>Validaci√≥n de datos y configuraci√≥n usando type hints de Python</p>
                    <span class="tag">Validation</span><span class="tag">Settings</span>
                </div>
            </div>

            <h3>üóÑÔ∏è Base de Datos</h3>
            <div class="info-grid">
                <div class="info-card">
                    <h4>PostgreSQL</h4>
                    <p>Sistema de gesti√≥n de base de datos relacional robusta</p>
                    <span class="tag success">Relational</span><span class="tag">SQL</span>
                </div>
                <div class="info-card">
                    <h4>SQLAlchemy</h4>
                    <p>ORM (Object-Relational Mapping) m√°s popular para Python</p>
                    <span class="tag">ORM</span><span class="tag">Database</span>
                </div>
                <div class="info-card">
                    <h4>Alembic</h4>
                    <p>Herramienta de migraci√≥n de base de datos para SQLAlchemy</p>
                    <span class="tag">Migrations</span><span class="tag">Versioning</span>
                </div>
            </div>

            <h3>üîê Autenticaci√≥n y Seguridad</h3>
            <div class="info-grid">
                <div class="info-card">
                    <h4>Firebase Admin SDK</h4>
                    <p>Autenticaci√≥n y gesti√≥n de usuarios con Google Firebase</p>
                    <span class="tag warning">Firebase</span><span class="tag">JWT</span>
                </div>
                <div class="info-card">
                    <h4>python-jose</h4>
                    <p>Implementaci√≥n de JSON Web Tokens (JWT) para Python</p>
                    <span class="tag">JWT</span><span class="tag">Crypto</span>
                </div>
                <div class="info-card">
                    <h4>passlib</h4>
                    <p>Biblioteca de hashing de contrase√±as con soporte bcrypt</p>
                    <span class="tag">Password</span><span class="tag">Bcrypt</span>
                </div>
            </div>

            <h3>üì¶ Dependencias Completas</h3>
            <div class="code-block">
fastapi==0.104.1
uvicorn[standard]==0.24.0
python-multipart==0.0.6
pydantic==2.5.0
pydantic-settings==2.1.0
python-dotenv==1.0.0
jinja2==3.1.2
aiofiles==23.2.1
python-jose[cryptography]==3.3.0
passlib[bcrypt]==1.7.4
email-validator==2.1.0
sqlalchemy==2.0.23
psycopg2-binary==2.9.9
alembic==1.13.0
firebase-admin==6.2.0
            </div>
        </section>

        <section id="configuracion" class="section">
            <h2>‚öôÔ∏è Configuraci√≥n</h2>
            
            <h3>üìù Variables de Entorno (.env)</h3>
            <div class="code-block">
# üè¢ Configuraci√≥n de la Aplicaci√≥n
APP_NAME=ByteDental Backend API
FROM_EMAIL=bytedental@company.com
FROM_NAME=ByteDental Team
FRONTEND_URL=http://localhost:5173

# üóÑÔ∏è Base de Datos PostgreSQL
DATABASE_URL=postgresql://username:password@localhost:5432/bytedental_db
DB_HOST=localhost
DB_PORT=5432
DB_NAME=bytedental_db
DB_USER=username
DB_PASSWORD=password

# üìß Configuraci√≥n SMTP (Gmail)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=tu-email@gmail.com
SMTP_PASSWORD=tu-app-password
SMTP_TLS=True
SMTP_SSL=False

# üî• Firebase
FIREBASE_CREDENTIALS_PATH=bytedental-***-firebase-adminsdk-***.json
            </div>

            <h3>üîß Configuraci√≥n Centralizada</h3>
            <p>La aplicaci√≥n utiliza <strong>Pydantic Settings</strong> para gesti√≥n centralizada de configuraci√≥n:</p>
            
            <div class="info-grid">
                <div class="info-card">
                    <h4>üèóÔ∏è Configuraci√≥n Autom√°tica</h4>
                    <p>Carga autom√°tica de variables desde archivo .env con valores por defecto</p>
                </div>
                <div class="info-card">
                    <h4>üîç Validaci√≥n de Tipos</h4>
                    <p>Validaci√≥n autom√°tica de tipos de datos usando Pydantic</p>
                </div>
                <div class="info-card">
                    <h4>üåç Multi-entorno</h4>
                    <p>Soporte para desarrollo, staging y producci√≥n</p>
                </div>
                <div class="info-card">
                    <h4>üîê Seguridad</h4>
                    <p>Variables sensibles separadas del c√≥digo fuente</p>
                </div>
            </div>

            <div class="code-block">
class Settings(BaseSettings):
    # SMTP Configuration
    smtp_host: str = "smtp.gmail.com"
    smtp_port: int = 587
    smtp_username: str = ""
    smtp_password: str = ""
    
    # Application Configuration  
    app_name: str = "ByteDental Email Service"
    from_email: str = ""
    frontend_url: str = "http://localhost:5173"
    
    # Database Configuration
    database_url: str = "postgresql://username:password@localhost:5432/bytedental_db"
    
    # Firebase
    firebase_credentials_path: str = "firebase-credentials.json"
            </div>
        </section>

        <section id="modelos" class="section">
            <h2>üìä Modelos de Base de Datos</h2>
            
            <h3>üë§ User Model (users)</h3>
            <div class="code-block">
class User(Base):
    __tablename__ = "users"
    
    uid = Column(String(128), primary_key=True)          # Firebase UID
    document_number = Column(String(20), nullable=False)  # N√∫mero documento
    document_type = Column(Enum('CC', 'TI', 'CE', 'PP'))# Tipo documento
    first_name = Column(String(100), nullable=False)     # Nombres
    last_name = Column(String(100), nullable=False)      # Apellidos
    email = Column(String(255), unique=True)             # Email √∫nico
    phone = Column(String(20), nullable=True)            # Tel√©fono
    role_id = Column(Integer, ForeignKey("roles.id"))    # Rol asignado
    specialty = Column(String(100), nullable=True)       # Especialidad
    is_active = Column(Boolean, default=True)            # Estado activo
    created_at = Column(TIMESTAMP, server_default=func.now())
    updated_at = Column(TIMESTAMP, onupdate=func.now())
            </div>

            <h3>üé≠ Role Model (roles)</h3>
            <div class="code-block">
class Role(Base):
    __tablename__ = "roles"
    
    id = Column(Integer, primary_key=True)
    name = Column(String(50), unique=True)        # Administrator, Doctor, etc.
    description = Column(Text)                    # Descripci√≥n del rol
    is_active = Column(Boolean, default=True)     # Estado del rol
    created_at = Column(TIMESTAMP, server_default=func.now())
    updated_at = Column(TIMESTAMP, onupdate=func.now())
            </div>

            <h3>üìã Audit Log Model (audit_logs)</h3>
            <div class="code-block">
class AuditLog(Base):
    __tablename__ = "audit_logs"
    
    id = Column(Integer, primary_key=True)
    event_type = Column(String(50))               # CREATE, UPDATE, DELETE, etc.
    user_id = Column(String(128))                 # UID del usuario que ejecuta
    affected_table = Column(String(50))           # Tabla afectada
    record_id = Column(String(128))               # ID del registro afectado
    old_values = Column(JSON)                     # Valores anteriores
    new_values = Column(JSON)                     # Valores nuevos
    ip_address = Column(String(45))               # IP del cliente
    user_agent = Column(Text)                     # Navegador/cliente
    details = Column(Text)                        # Detalles adicionales
    created_at = Column(TIMESTAMP, server_default=func.now())
            </div>

            <h3>üìß Email Model (emails)</h3>
            <div class="code-block">
class Email(Base):
    __tablename__ = "emails"
    
    id = Column(Integer, primary_key=True)
    from_email = Column(String(255))              # Email origen
    to_email = Column(String(255))                # Email destino
    subject = Column(String(255))                 # Asunto
    body = Column(Text)                           # Cuerpo del email
    email_type = Column(String(50))               # GENERAL, OTP, etc.
    status = Column(String(20))                   # SENT, FAILED, PENDING
    sent_at = Column(TIMESTAMP)                   # Fecha de env√≠o
    created_at = Column(TIMESTAMP, server_default=func.now())
            </div>

            <h3>üî¢ OTP Model (otp_codes)</h3>
            <div class="code-block">
class OTPCode(Base):
    __tablename__ = "otp_codes"
    
    id = Column(Integer, primary_key=True)
    email = Column(String(255))                   # Email del destinatario
    code = Column(String(6))                      # C√≥digo de 6 d√≠gitos
    purpose = Column(String(50))                  # PASSWORD_RESET, VERIFICATION
    is_used = Column(Boolean, default=False)      # Si ya fue usado
    expires_at = Column(TIMESTAMP)                # Fecha de expiraci√≥n
    created_at = Column(TIMESTAMP, server_default=func.now())
            </div>

            <h3>üóÇÔ∏è Relaciones Entre Modelos</h3>
            <div class="architecture-diagram">
Users ‚îÄ‚îÄ‚îê
        ‚îú‚îÄ‚îÄ Role (Many-to-One)
        ‚îî‚îÄ‚îÄ AuditLogs (One-to-Many via user_id)

Emails ‚îÄ‚îÄ‚îÄ‚îÄ Users (via email field)
OTPCodes ‚îÄ‚îÄ Users (via email field)
            </div>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Tabla</th>
                            <th>Campos Principales</th>
                            <th>Relaciones</th>
                            <th>Prop√≥sito</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>users</strong></td>
                            <td>uid, email, first_name, last_name, role_id</td>
                            <td>Many-to-One con roles</td>
                            <td>Gesti√≥n de usuarios del sistema</td>
                        </tr>
                        <tr>
                            <td><strong>roles</strong></td>
                            <td>id, name, description</td>
                            <td>One-to-Many con users</td>
                            <td>Definici√≥n de roles y permisos</td>
                        </tr>
                        <tr>
                            <td><strong>audit_logs</strong></td>
                            <td>event_type, user_id, old_values, new_values</td>
                            <td>Referencia users via user_id</td>
                            <td>Trazabilidad de todas las acciones</td>
                        </tr>
                        <tr>
                            <td><strong>emails</strong></td>
                            <td>from_email, to_email, subject, status</td>
                            <td>Referencia users via email</td>
                            <td>Historial de comunicaciones</td>
                        </tr>
                        <tr>
                            <td><strong>otp_codes</strong></td>
                            <td>email, code, purpose, expires_at</td>
                            <td>Referencia users via email</td>
                            <td>C√≥digos de verificaci√≥n temporales</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <section id="autorizacion" class="section">
            <h2>üõ°Ô∏è Sistema de Autorizaci√≥n</h2>
            
            <h3>üé≠ Roles del Sistema</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Rol</th>
                            <th>Descripci√≥n</th>
                            <th>Permisos Principales</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="tag danger">üëë Administrator</span></td>
                            <td>Administrador del sistema</td>
                            <td>‚Ä¢ CRUD completo de usuarios<br>‚Ä¢ Gesti√≥n de roles<br>‚Ä¢ Configuraci√≥n del sistema</td>
                        </tr>
                        <tr>
                            <td><span class="tag info">üîç Auditor</span></td>
                            <td>Auditor del sistema</td>
                            <td>‚Ä¢ Solo lectura de logs de auditor√≠a<br>‚Ä¢ Consulta de actividades<br>‚Ä¢ Generaci√≥n de reportes</td>
                        </tr>
                        <tr>
                            <td><span class="tag success">üë®‚Äç‚öïÔ∏è Doctor</span></td>
                            <td>Profesional m√©dico</td>
                            <td>‚Ä¢ Acceso al dashboard<br>‚Ä¢ Gesti√≥n de pacientes<br>‚Ä¢ Consulta de informaci√≥n</td>
                        </tr>
                        <tr>
                            <td><span class="tag warning">üë©‚Äçüíº Assistant</span></td>
                            <td>Asistente dental</td>
                            <td>‚Ä¢ Acceso limitado al dashboard<br>‚Ä¢ Tareas administrativas b√°sicas</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>üîê Middleware de Autorizaci√≥n</h3>
            <div class="code-block">
# Funciones de autorizaci√≥n disponibles:
get_current_user()           # Usuario autenticado b√°sico
get_current_admin_user()     # Solo Administrators
get_current_auditor_user()   # Solo Auditors

# Ejemplo de endpoint protegido
@router.get("/users", dependencies=[Depends(get_current_admin_user)])
async def list_users():
    # Solo accesible para Administrators
    pass

@router.get("/auditoria", dependencies=[Depends(get_current_auditor_user)])  
async def get_audit_logs():
    # Solo accesible para Auditors
    pass
            </div>

            <h3>üéØ Matriz de Permisos</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Funcionalidad</th>
                            <th>üëë Administrator</th>
                            <th>üîç Auditor</th>
                            <th>üë®‚Äç‚öïÔ∏è Doctor</th>
                            <th>üë©‚Äçüíº Assistant</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Gesti√≥n de Usuarios</strong></td>
                            <td><span class="tag success">‚úÖ CRUD Completo</span></td>
                            <td><span class="tag danger">‚ùå Sin Acceso</span></td>
                            <td><span class="tag danger">‚ùå Sin Acceso</span></td>
                            <td><span class="tag danger">‚ùå Sin Acceso</span></td>
                        </tr>
                        <tr>
                            <td><strong>Logs de Auditor√≠a</strong></td>
                            <td><span class="tag danger">‚ùå Sin Acceso</span></td>
                            <td><span class="tag success">‚úÖ Solo Lectura</span></td>
                            <td><span class="tag danger">‚ùå Sin Acceso</span></td>
                            <td><span class="tag danger">‚ùå Sin Acceso</span></td>
                        </tr>
                        <tr>
                            <td><strong>Dashboard</strong></td>
                            <td><span class="tag success">‚úÖ Acceso</span></td>
                            <td><span class="tag success">‚úÖ Acceso</span></td>
                            <td><span class="tag success">‚úÖ Acceso</span></td>
                            <td><span class="tag success">‚úÖ Acceso</span></td>
                        </tr>
                        <tr>
                            <td><strong>Gesti√≥n de Emails</strong></td>
                            <td><span class="tag success">‚úÖ Completo</span></td>
                            <td><span class="tag warning">‚ö†Ô∏è Limitado</span></td>
                            <td><span class="tag warning">‚ö†Ô∏è Limitado</span></td>
                            <td><span class="tag warning">‚ö†Ô∏è Limitado</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>üîç Flujo de Autorizaci√≥n</h3>
            <div class="info-grid">
                <div class="info-card">
                    <h4>1Ô∏è‚É£ Request con JWT</h4>
                    <p>Cliente env√≠a request con token Bearer en headers</p>
                </div>
                <div class="info-card">
                    <h4>2Ô∏è‚É£ Validaci√≥n Firebase</h4>
                    <p>Middleware valida token JWT con Firebase Admin SDK</p>
                </div>
                <div class="info-card">
                    <h4>3Ô∏è‚É£ Verificaci√≥n Usuario</h4>
                    <p>Busca usuario en BD y verifica estado activo</p>
                </div>
                <div class="info-card">
                    <h4>4Ô∏è‚É£ Autorizaci√≥n Rol</h4>
                    <p>Verifica que el rol tenga permisos para el endpoint</p>
                </div>
                <div class="info-card">
                    <h4>5Ô∏è‚É£ Ejecuci√≥n</h4>
                    <p>Procesa request y registra acci√≥n en auditor√≠a</p>
                </div>
                <div class="info-card">
                    <h4>6Ô∏è‚É£ Response</h4>
                    <p>Retorna resultado al cliente con logging completo</p>
                </div>
            </div>
        </section>

        <section id="instalacion" class="section">
            <h2>üöÄ Gu√≠a de Instalaci√≥n</h2>
            
            <h3>üìã Prerrequisitos</h3>
            <div class="features-list">
                <div class="feature-item">üêç <strong>Python 3.8+</strong> instalado</div>
                <div class="feature-item">üóÑÔ∏è <strong>PostgreSQL 12+</strong> configurado</div>
                <div class="feature-item">üî• <strong>Firebase Project</strong> creado</div>
                <div class="feature-item">üìß <strong>Gmail Account</strong> con App Password</div>
            </div>

            <h3>üîß Pasos de Instalaci√≥n</h3>
            
            <h4>1Ô∏è‚É£ Clonar y configurar entorno</h4>
            <div class="code-block">
git clone &lt;repository&gt;
cd backend
python -m venv venv
venv\Scripts\activate  # Windows
# source venv/bin/activate  # Linux/Mac
            </div>

            <h4>2Ô∏è‚É£ Instalar dependencias</h4>
            <div class="code-block">
pip install -r requirements.txt
            </div>

            <h4>3Ô∏è‚É£ Configurar variables de entorno</h4>
            <div class="code-block">
# Crear archivo .env con la configuraci√≥n necesaria
cp .env.example .env
# Editar .env con tus valores
            </div>

            <h4>4Ô∏è‚É£ Configurar Base de Datos</h4>
            <div class="code-block">
# Usando Docker (recomendado)
docker-compose up -d

# O manual PostgreSQL
createdb bytedental_db
            </div>

            <h4>5Ô∏è‚É£ Ejecutar migraciones</h4>
            <div class="code-block">
alembic upgrade head
            </div>

            <h4>6Ô∏è‚É£ Insertar roles iniciales</h4>
            <div class="code-block">
python scripts/insert_roles.py
            </div>

            <h4>7Ô∏è‚É£ Iniciar servidor</h4>
            <div class="code-block">
# Desarrollo
uvicorn main:app --reload --host 0.0.0.0 --port 8000

# Producci√≥n
uvicorn main:app --host 0.0.0.0 --port 8000
            </div>

            <div class="highlight-box">
                <h3>üéâ ¬°Listo!</h3>
                <p>Tu servidor ByteDental Backend est√° ejecut√°ndose en:</p>
                <p><strong>üåê API: http://localhost:8000</strong></p>
                <p><strong>üìö Docs: http://localhost:8000/docs</strong></p>
                <p><strong>üè• Health: http://localhost:8000/health</strong></p>
            </div>
        </section>

        <footer>
            <h2>ü¶∑ ByteDental Backend</h2>
            <p><strong>Documentaci√≥n T√©cnica Completa</strong></p>
            <p>API REST con FastAPI - Versi√≥n 2.0.0</p>
            <p>Sistema de gesti√≥n odontol√≥gica con autorizaci√≥n por roles</p>
            <br>
            <div style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap;">
                <span class="tag">FastAPI</span>
                <span class="tag">PostgreSQL</span>
                <span class="tag">Firebase Auth</span>
                <span class="tag">Docker</span>
                <span class="tag">Python</span>
            </div>
            <br>
            <p><em>√öltima actualizaci√≥n: Septiembre 11, 2025</em></p>
        </footer>

    </div>

    <script>
        // Smooth scrolling para navegaci√≥n
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Highlight del men√∫ de navegaci√≥n
        window.addEventListener('scroll', () => {
            const sections = document.querySelectorAll('.section');
            const navItems = document.querySelectorAll('.nav-item');
            
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (pageYOffset >= sectionTop - 200) {
                    current = section.getAttribute('id');
                }
            });

            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === '#' + current) {
                    item.classList.add('active');
                }
            });
        });
    </script>

    <style>
        .nav-item.active {
            background: #5a67d8 !important;
            color: white !important;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(90, 103, 216, 0.3);
        }
    </style>

</body>
</html>
